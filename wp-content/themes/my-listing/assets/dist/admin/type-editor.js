document.getElementById("case27-listing-type-options")&&(MyListing.TypeEditor=new Vue({el:"#case27-listing-options-inside",data:{postid:null,currentTab:"settings",currentSubTab:"general",drag:!1,state:{fields:{editingOptions:!1,new_field_type:"text",active:null},single:{active_button:null,active_menu_item:null,active_block:null},result:{},search:{new_facet_type:"wp-search",active_form:"advanced"},settings:{packages:CASE27_TypeDesigner.listing_packages,new_package:"",jsoneditor:!1,view_more:!1}},blueprints:{menu_page:{defaults:{page:"main",label:"New Page",label_l10n:{locale:"en_US"}},main:{page:"main",layout:[],sidebar:[],template:"masonry"},comments:{page:"comments"},related_listings:{page:"related_listings",related_listing_type:null},custom:{page:"custom",layout:[],sidebar:[],template:"masonry"},store:{page:"store",field:""},bookings:{page:"bookings",field:"",provider:[],contact_form_id:0}},fields:CASE27_TypeDesigner.blueprints.fields,cover_button:{action:"custom-field",custom_field:"",label:"[[field]]",label_l10n:{locale:"en_US"},style:"none",icon:""},facet:{type:"text",label:"New Facet",placeholder:"",search_field:""},facet_types:[{type:"wp-search",label:"General Search Box",placeholder:"Enter keywords..."},{type:"location",label:"Listing Location",placeholder:"Enter location..."},{type:"text",label:"Text Search",show_field:"",allowed_fields:["text","texteditor","wp-editor","checkbox","radio","select","multiselect","textarea","date","email","url","number"],placeholder:""},{type:"proximity",label:"Proximity",options:[{label:"Units",name:"units",type:"select",choices:{metric:"Kilometres",imperial:"Miles"},value:"metric"},{label:"Step size",name:"step",type:"number",value:1},{label:"Max value",name:"max",type:"number",value:500},{label:"Default value",name:"default",type:"number",value:10}]},{type:"date",label:"Date",show_field:"",allowed_fields:["date"],options:[{label:"Type",name:"type",type:"select",choices:{exact:"Exact Date",range:"Date Range"},value:"exact"},{label:"Format",name:"format",type:"select",choices:{ymd:"Year + Month + Day",year:"Years Only"},value:"ymd"}]},{type:"range",label:"Range",show_field:"",allowed_fields:["text","number"],options:[{label:"Type",name:"type",type:"select",choices:{range:"Range Slider",simple:"Single Slider"},value:"range"},{label:"Step size",name:"step",type:"number",value:1},{label:"Prefix",name:"prefix",type:"text",value:""},{label:"Suffix",name:"suffix",type:"text",value:""},{label:"Format Value",name:"format_value",type:"checkbox",value:0}]},{type:"dropdown",label:"Dropdown",show_field:"",allowed_fields:["text","checkbox","radio","select","multiselect","date","term-multiselect","term-select","related-listing","number","location"],options:[{label:"Placeholder",name:"placeholder",type:"text",value:""},{label:"Count",name:"count",type:"number",value:8},{label:"Order by",name:"order_by",type:"select",value:"count",choices:{name:"Name",count:"Count",meta_value:"Value",meta_value_num:"Numerical Value",include:"Include Order"}},{label:"Order",name:"order",type:"select",value:"DESC",choices:{ASC:"Ascending",DESC:"Descending"}},{label:"Hide empty?",name:"hide_empty",type:"checkbox",value:1},{label:"Multiselect?",name:"multiselect",type:"checkbox",value:1,form:"advanced"}]},{type:"checkboxes",label:"Checkboxes",show_field:"",allowed_fields:["term-multiselect","term-select","text","select","multiselect","checkbox","radio","number","location"],options:[{label:"Count",name:"count",type:"number",value:8},{label:"Order by",name:"order_by",type:"select",value:"count",choices:{name:"Name",count:"Count",meta_value:"Value",meta_value_num:"Numerical Value",include:"Include Order"}},{label:"Order",name:"order",type:"select",value:"DESC",choices:{ASC:"Ascending",DESC:"Descending"}},{label:"Hide empty?",name:"hide_empty",type:"checkbox",value:1},{label:"Multiselect?",name:"multiselect",type:"checkbox",value:1}],form:"advanced"}],layout_blocks:CASE27_TypeDesigner.blueprints.layout_blocks,structured_data:CASE27_TypeDesigner.blueprints.structured_data,map_skins:{},preview:{sections:{categories:{type:"categories",title:"Terms",taxonomy:"job_listing_category",show_bookmark_button:"",show_quick_view_button:""},host:{type:"host",title:"Related Listing",label:"[[listing_name]]",show_bookmark_button:"",show_quick_view_button:""},author:{type:"author",title:"Author",label:"[[author]]",show_bookmark_button:"",show_quick_view_button:""},details:{type:"details",title:"Details",details:[],show_bookmark_button:"",show_quick_view_button:""},actions:{type:"actions",title:"Actions",show_bookmark_button:"",show_quick_view_button:""}}}},fields:CASE27_TypeDesigner.schemes.fields,single:CASE27_TypeDesigner.schemes.single,result:CASE27_TypeDesigner.schemes.result,search:CASE27_TypeDesigner.schemes.search,settings:CASE27_TypeDesigner.schemes.settings},created:function(){this.postid=jQuery("#case27-post-id").val(),this.blueprints.map_skins=CASE27.map_skins,this.getListingMeta()},mounted:function(){this.$nextTick(function(){this.setupSeoSettings()}.bind(this))},methods:{setTab:function(e,t){this.currentTab=e,this.currentSubTab=t},clone:function(e){return Vue.util.extend({},e)},getListingMeta:function(){var e=CASE27_TypeDesigner.config;this.setupFields(e.fields.available,e.fields.used),this.setupSinglePage(e.single),this.setupPreviewCard(e.result),this.search=jQuery.extend({},this.search,e.search),this.setupSearchForms(),this.setupOrderingOptions(),this.settings=jQuery.extend({},this.settings,e.settings),this.setupReviewSettings()},setupFields:function(e,t){var i=[],s=this;this.fields.used=Object.keys(t).map(function(n){if(i.push(t[n].slug),void 0!==e[n]){var a=jQuery.extend({},e[n],t[n]);return Object.keys(a).map(function(t){void 0===e[n][t]&&delete a[t]}),a.default_label=e[n].label,a.type=e[n].type,a}var r=jQuery.extend(!0,{},s.blueprints.fields[t[n].type]);a=jQuery.extend({},r,t[n]);return Object.keys(a).map(function(e){void 0===r[e]&&delete a[e]}),a}),this.fields.used=this.fields.used.filter(function(e){return"object"==typeof e}),this.fields.available=Object.keys(e).map(function(t){return e[t]}),this.fields.available=this.fields.available.filter(function(e){return!(-1!==jQuery.inArray(e.slug,i))}),this.fields.available.forEach(function(e,t){"job_title"!=e.slug&&"job_description"!=e.slug||(this.fields.used.push(jQuery.extend({},e)),this.fields.available.splice(t,1)),e.default_label=e.label}.bind(this)),this.fields.used.forEach(function(e,t){"job_title"!=e.slug&&"job_description"!=e.slug||(e.required=!0,e.show_in_admin=!0,e.show_in_submit_form=!0,e.conditional_logic=!1,e.conditions=[])}.bind(this))},setupSinglePage:function(e){var t=this;t.single=jQuery.extend({},t.single,e),t.single.menu_items=Object.keys(t.single.menu_items).map(function(e){var i=jQuery.extend(!0,{},t.blueprints.menu_page.defaults,t.blueprints.menu_page[t.single.menu_items[e].page]),s=jQuery.extend({},i,t.single.menu_items[e]);return Object.keys(s).map(function(e){void 0===i[e]&&delete s[e]}),s}),t.single.menu_items.map(function(e){if(void 0!==e.layout){["layout","sidebar"].forEach(function(i){var s=[];e[i].forEach(function(e,i){if(void 0!==t.blueprints.layout_blocks[e.type]){var n=jQuery.extend(!0,{},t.blueprints.layout_blocks[e.type]);e=jQuery.extend({},n,e);if(Object.keys(e).map(function(t){void 0===n[t]&&delete e[t]}),n.options){var a=[];n.options.forEach(function(t,i){var s=jQuery.extend({},t);e.options.forEach(function(e,i){t.name==e.name&&(s.value=e.value)}),a.push(s)}),e.options=a}void 0!==e.icon&&-1!==["view_headline","insert_photo","view_module","map","email","layers","av_timer","attach_file","alarm","videocam","account_circle"].indexOf(e.icon)&&(e.icon="mi "+e.icon),s.push(e)}}),e[i]=s})}return e}),t.single.buttons=t.single.buttons.map(function(e,i){var s=jQuery.extend(!0,{},t.blueprints.cover_button);return Object.keys(s).forEach(function(t){void 0!==e[t]&&(s[t]=e[t])}),s})},setupPreviewCard:function(e){var t=this;if(!e)return!1;e.footer.sections=e.footer.sections.map(function(e){var i=jQuery.extend(!0,{},t.blueprints.preview.sections[e.type]);return!!i&&(Object.keys(i).map(function(t){void 0!==e[t]&&(i[t]=e[t])}),i)}),t.result=e},setupSearchForms:function(){var e=this;this.search.advanced.facets=this.search.advanced.facets.map(function(t){return e.setupFacet(t)}),this.search.basic.facets=this.search.basic.facets.map(function(t){return e.setupFacet(t)}),this.search.advanced.facets=this.search.advanced.facets.filter(function(e){return"order"!==e.type})},setupOrderingOptions:function(){this.search.order.options.length||this.searchTab().setDefaultOrderOptions(),this.search.order.options.forEach(function(e){e.is_new=!1})},setupFacet:function(e){var t=this.blueprints.facet_types.filter(function(t){return t.type===e.type})[0];if(void 0!==t){var i=jQuery.extend({},t,e);return i.options=[],Array.isArray(t.options)&&t.options.forEach(function(t){var s=e.options.filter(function(e){return e.name===t.name})[0];void 0!==s&&(t.value=s.value),i.options.push(jQuery.extend({},t))}),i}return e},setupReviewSettings:function(){this.settings.reviews.ratings.categories.length<1&&this.settings.reviews.ratings.categories.push({id:"rating",label:"Overall Rating",label_l10n:{},is_new:!1}),this.settings.reviews.ratings.categories.forEach(function(e){e.is_new=!1})},setDefaultSeoMarkup:function(){confirm("Are you sure?")&&(this.$set(this.settings.seo,"markup",this.blueprints.structured_data),this.state.settings.jsoneditor.set(this.settings.seo.markup))},setupSeoSettings:function(){var e=this;(!this.settings.seo.markup||"object"!=typeof this.settings.seo.markup||Object.keys(this.settings.seo.markup).length<1)&&this.$set(this.settings.seo,"markup",this.blueprints.structured_data);var t=new JSONEditor(document.getElementById("lte-seo-markup"),{mode:"tree",modes:["tree","text"],search:!1,onChange:function(){e.$set(e.settings.seo,"markup",t.get())},autocomplete:{caseSensitive:!1,getOptions:function(t,i,s,n){var a=e.allFields();return Object.keys(a).map(function(e){return CASE27_TypeDesigner.fieldAliases[a[e].slug]?"[["+CASE27_TypeDesigner.fieldAliases[a[e].slug]+"]]":"[["+a[e].slug+"]]"})}}});t.set(this.settings.seo.markup),this.state.settings.jsoneditor=t},fieldsTab:function(){var e=this;return{addField:function(){if(!e.state.fields.new_field_type)return!1;var t=jQuery.extend(!0,{},e.blueprints.fields[e.state.fields.new_field_type]);t.is_new=!0,e.fields.used.push(t),e.fieldsTab().setKey(t,t.label)},deleteField:function(t){var i=null;e.fields.used=e.fields.used.filter(function(e){return e.slug===t.slug&&(i=e),e.slug!==t.slug}),i&&1!=i.is_custom&&e.fields.available.push(i)},useField:function(t){var i=null;e.fields.available=e.fields.available.filter(function(e){return e.slug===t.slug&&(i=e),e.slug!==t.slug}),i&&e.fields.used.push(i)},setKey:function(t,i){if(t.is_custom&&t.is_new){var s=e.slugify(i);t.slug=s}},editFieldOptions:function(e,t){t.options={},jQuery(e.target).val().trim().split("\n").map(function(e,i){if(e.length<1)return!1;var s=e.split(":");return 1===s.length?t.options[s[0].trim()]=s[0].trim():2===s.length&&(t.options[s[0].trim()]=s[1].trim())})},editFieldMimeTypes:function(e,t){t.allowed_mime_types={},jQuery(e.target).val().map(function(e,i){var s=e.split("=>");if(!s[0]||!s[1])return!1;t.allowed_mime_types[s[0].trim()]=s[1].trim()})}}},slugify:function(e){return e.toString().trim().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")},sanitize_title:function(e){return MyListing.Helpers.sanitize_title(e)},onFieldMove:function(e){if((jQuery(e.dragged).hasClass("field-wrapper-name--job_title")||jQuery(e.dragged).hasClass("field-wrapper-name--job_description"))&&jQuery(e.to).hasClass("available-fields"))return!1},addCoverButton:function(){var e=jQuery.extend(!0,{},this.blueprints.cover_button);this.single.buttons.push(e),this.state.single.active_button=e},deleteCoverButton:function(e){this.single.buttons=this.single.buttons.filter(function(t){return t!==e}),this.state.single.active_button===e&&(this.state.single.active_button=null)},addMenuItem:function(e){if("none"!=e.target.value&&e.target.value){var t=jQuery.extend(!0,{},this.blueprints.menu_page.defaults,this.blueprints.menu_page[e.target.value]);this.single.menu_items.push(t),this.state.single.active_menu_item=t,e.target.value="none"}},deleteMenuItem:function(e){this.single.menu_items=this.single.menu_items.filter(function(t){return t!==e}),this.state.single.active_menu_item===e&&(this.state.single.active_menu_item=null)},addBlock:function(){var e=jQuery("#single-add-block").val();if("none"==e||void 0===this.blueprints.layout_blocks[e])return!1;this.state.single.active_menu_item.layout.push(jQuery.extend(!0,{},this.blueprints.layout_blocks[e]))},deleteBlock:function(e,t){this.state.single.active_menu_item[t]=this.state.single.active_menu_item[t].filter(function(t){return t!==e})},moveBlock:function(e,t){var i="layout"==t?"sidebar":"layout";this.state.single.active_menu_item[t]=this.state.single.active_menu_item[t].filter(function(t){return t!==e}),this.state.single.active_menu_item[i].push(e)},resultTab:function(){var e=this;return{addButton:function(){e.result.buttons.push({label:"[[field]]",show_field:""})},deleteButton:function(t){e.result.buttons=e.result.buttons.filter(function(e){return e!==t})},addField:function(){e.result.info_fields.push({label:"[[field]]",show_field:"",icon:""})},deleteField:function(t){e.result.info_fields=e.result.info_fields.filter(function(e){return e!==t})},addSection:function(){var t=jQuery("#result-add-section").val();"none"!=t&&e.result.footer.sections.push(jQuery.extend(!0,{},e.blueprints.preview.sections[t]))},deleteSection:function(t){e.result.footer.sections=e.result.footer.sections.filter(function(e){return e!==t})},addDetail:function(e){void 0===e.details&&(e.details=[]),e.details.push({label:"[[field]]",show_field:"",icon:""})},deleteDetail:function(e,t){t.details=t.details.filter(function(t){return t!==e})}}},searchTab:function(){var e=this;return{addFacet:function(t){var i=e.blueprints.facet_types.filter(function(t){return t.type==e.state.search.new_facet_type})[0],s=jQuery.extend(!0,{},i);e.search[t].facets.push(s)},deleteFacet:function(t,i){e.search[i].facets=e.search[i].facets.filter(function(e){return e!==t})},addOption:function(t,i,s,n,a,r,l,o){e.search.order.options.push({label:t||"New option",key:i||"new-option",ignore_priority:o||!1,is_new:!0,clauses:[{orderby:s||"date",order:n||"DESC",context:a||"option",type:r||"CHAR",custom_type:l||!1}]})},removeOption:function(t){e.search.order.options=e.search.order.options.filter(function(e){return t!==e})},addClause:function(e){e.clauses.push({orderby:"date",order:"DESC",context:"option",type:"CHAR",custom_type:!1})},removeClause:function(e,t){t.clauses=t.clauses.filter(function(t){return e!==t})},setOptionKey:function(t){t.is_new&&(t.key=e.slugify(t.label))},setDefaultOrderOptions:function(){e.search.order.options=[],e.searchTab().addOption("Latest","latest","date","DESC","option"),e.searchTab().addOption("Top rated","top-rated","rating","DESC","option","DECIMAL(10,2)"),e.searchTab().addOption("Random","random","rand","DESC","option")}}},fieldsByType:function(e){return this.fields.used.filter(function(t){return"object"==typeof t&&-1!==jQuery.inArray(t.type,e)}).map(function(e){return{slug:e.slug,label:e.label}})},fieldsByFacetType:function(e){var t=[];return this.blueprints.facet_types.map(function(i){i.type===e&&(t=i.allowed_fields)}),this.fieldsByType(t)},allFields:function(){return this.fields.used.filter(function(e){return"object"==typeof e}).map(function(e){return{slug:e.slug,label:e.label}})},fieldByName:function(e){var t=this.fields.used.filter(function(t){return t.slug===e});return!!t.length&&t[0]},fieldsByTypeFormatted:function(e){if(!jQuery.isArray(e))return e;var t=this.fieldsByType(e),i={};return t.forEach(function(e){i[e.slug]=e.label}),i},exportConfig:function(){var e,t=JSON.stringify({fields:this.fields,single:this.single,result:this.result,search:this.search,settings:this.settings}),i=null,s=document.createElement("a");s.href=(e=new Blob([t],{type:"text/plain"}),null!==i&&window.URL.revokeObjectURL(i),i=window.URL.createObjectURL(e)),s.download=(this.settings.singular_name?this.settings.singular_name.toLowerCase()+".":"").replace(/\s+/g,"-")+"listing-config.json",s.click()},startImportConfig:function(){document.getElementById("c27-import-config").click()},importConfig:function(e){var t=this,i=e.target.files[0],s=new FileReader;s.onload=function(e){var i=e.target.result;try{var s=JSON.parse(i);void 0!==s.fields&&t.$set(t.$data,"fields",jQuery.extend(!0,CASE27_TypeDesigner.schemes.fields,s.fields)),void 0!==s.single&&t.$set(t.$data,"single",jQuery.extend(!0,CASE27_TypeDesigner.schemes.single,s.single)),void 0!==s.result&&t.$set(t.$data,"result",jQuery.extend(!0,CASE27_TypeDesigner.schemes.result,s.result)),void 0!==s.search&&t.$set(t.$data,"search",jQuery.extend(!0,CASE27_TypeDesigner.schemes.search,s.search)),void 0!==s.settings&&t.$set(t.$data,"settings",jQuery.extend(!0,CASE27_TypeDesigner.schemes.settings,s.settings))}catch(e){return alert("Error. "+e.message)}},s.readAsText(i,"UTF-8")},capitalize:function(e){if("string"!=typeof e||!e.length)return e;for(var t=e.split(/[\s,_-]+/),i=0;i<t.length;i++){var s=t[i];t[i]=s.charAt(0).toUpperCase()+s.slice(1)}return t.join(" ").replace(/^Job\s/,"")},formatLabel:function(e,t){var i=this.fieldByName(t)?this.fieldByName(t).label:this.capitalize(t);return this.capitalize(e.replace("[[field]]",i).replace(/\[27-format(.*?)?\]/g,"").replace(/\[\/27-format\]/g,""))},conditions:function(){return{addOrCondition:function(e){e.conditions.push([{key:"__listing_package",value:"",compare:"=="}])},deleteConditionGroup:function(e,t){t.conditions=t.conditions.filter(function(t){return e!==t})}}},packages:function(){var e=this;return{add:function(){return void 0!==e.state.settings.packages[e.state.settings.new_package]&&(!e.packages().isPackageUsed(e.state.settings.new_package)&&void e.settings.packages.used.push({package:e.state.settings.new_package,label:"",description:"",featured:!1}))},remove:function(t){e.settings.packages.used=e.settings.packages.used.filter(function(e){return t!==e})},getPackageDefaultTitle:function(t){return void 0===e.state.settings.packages[t.package]?"":e.state.settings.packages[t.package]},getPackageTitle:function(t){return t.label?t.label:e.packages().getPackageDefaultTitle(t)},isPackageUsed:function(t){var i=!1;return e.settings.packages.used.forEach(function(e){e.package===t&&(i=!0)}),i}}},reviews:function(){var e=this;return{addCategory:function(){e.settings.reviews.ratings.categories.push({id:"category-key",label:"Category Name",label_l10n:{},is_new:!0})},removeCategory:function(t){e.settings.reviews.ratings.categories=e.settings.reviews.ratings.categories.filter(function(e){return t!==e})}}}},watch:{currentSubTab:function(e){this.state.search.active_form="basic"==e?"basic":"advanced"}},computed:{custom_fields:function(){return this.fields.used.filter(function(e){return e.is_custom})},cover_button_fields:function(){return this.fields.used.filter(function(e){return e.is_custom||-1!==jQuery.inArray(e.slug,["job_title","job_tagline","job_location","job_email","job_website","job_phone","job_type","job_video_url","application","job_date","price_range"])})},fields_json_string:function(){return JSON.stringify(this.fields.used)},single_page_options_json_string:function(){return JSON.stringify(this.single)},result_template_json_string:function(){return JSON.stringify(this.result)},search_page_json_string:function(){return JSON.stringify(this.search)},settings_page_json_string:function(){return JSON.stringify(this.settings)}}}));
//# sourceMappingURL=type-editor.js.map
